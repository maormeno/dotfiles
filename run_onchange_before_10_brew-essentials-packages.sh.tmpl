{{- if eq .chezmoi.os "darwin" -}}
#!/bin/bash
set -euo pipefail

# Trigger rerun when the essentials Brewfile content changes.
# brewfile-sha256: {{ include "dot_Brewfile.essentials" | sha256sum }}

if ! command -v brew >/dev/null 2>&1; then
  echo "Homebrew is required to install essentials packages."
  exit 1
fi

# Install/update essentials directly from managed source content.
brew bundle --file=/dev/stdin <<'EOF'
{{ include "dot_Brewfile.essentials" }}
EOF
{{- end -}}
